# VBA-DownloadsCleaner

# 🧹 ダウンロードフォルダ大掃除マクロ (VBA)！

「年末と言えば！大掃除！！」
と言うワケで~~大掃除してないことの言い訳で~~作った、ダウンロードフォルダ整理するためのVBAコード群です。

※ただし現在、Office環境がないためソースコードのみ公開しています。
上手く動いてくれるとよいのですが！

## 🌟 これは何？
気付いたら第二のゴミ箱になりがちな「ダウンロード」フォルダの中身を、ルールに従って仕分けします。
- 仕分けた物はデスクトップにフォルダを作って突っ込みます。
- 削除してよさそうなものも一応削除予定フォルダに突っ込むので、要らなかったら丸ごとゴミ箱にシュートしてください。
- え？それぞれのフォルダの中身くらいは自分で掃除してくださいよ～！

## 📂 モジュール構成と役割
「事務員さんの闇マクロもこんぐらい出来ますぞ」というこだわりを詰め込んだ構成です。

### 1. クラスモジュール (Logic & DTO)
オブジェクト指向っぽく設計しており、拡張性が高いのが自慢です。へへ。

| クラス名 | 役割 | こだわりポイント |
| :--- | :--- | :--- |
| **FileDTO** | ファイル情報の運び役 | **カプセル化＆バリデーション実装。** 一時ファイルを対象外にしたり、拡張子を小文字に統一したりと、データの入り口を整えます。 |
| **IFileAction** | アクションのインターフェース | すべての「お掃除アクション」の共通ルールを定義。 |
| **ZipAction** | ZIPファイルの処理 | 7日以上前のものは「削除予定」へ、それ以外は「zip」フォルダへ仕分け。 |
| **PdfAction** | PDFファイルの処理 | 30日以上前のものは「削除予定」へ、それ以外は「pdf」フォルダへ。 |
| **ImageAction** | 画像ファイルの処理 | jpg, pngなどを「画像」フォルダへひとまとめ。 |
| **MusicAction** | 音楽ファイルの処理 | mp3などを「音楽」フォルダへ。 |
| **OtherAction** | その他ファイルの処理 | 上記以外を10日基準で「削除予定」か「その他」へ。 |
| **ActionFactory** | インスタンス生成工場 | 拡張子を見て、どのアクション（クラス）を呼ぶかを自動で判断します。 |

### 2. 標準モジュール (Common & Main)
エラー処理や共通ツールなどを切り分けて、メンテナンスしやすくしています。

| モジュール名 | 役割 | 内容 |
| :--- | :--- | :--- |
| **MainModule** | メインプロセス | ダウンロードフォルダからファイルを1つずつ取り出し、掃除を実行します。 |
| **Utils** | 共通ユーティリティ | フォルダ作成や、ファイル名の重複回避（リネーム処理）を担当。 |
| **ErrorManager** | エラーハンドリング | エラーが連続（10回）した際の中断処理などを一括管理。 |

## 🛠 実装のこだわり
- **インターフェースの活用**: `IFileAction` を使うことで、新しい仕分けルール（例：Excel用、動画用など）を簡単に追加できるようにしました。
- **重複回避ロジック**: 同名のファイルがあっても、`_yyyymmdd` や連番 `(n)` を付与して上書きを防ぐ優しさ設計。
- **バリデーション**: DTO側で「一時ファイルはスルーする」などの制御を行い、メインロジックを汚さないようにしています。

## 🚀 使い方
1. Excel（またはAccess等）のVBEを開きます。
2. 各ファイルをモジュールとしてインポート（またはコピペ）してください。
3. `MainProcess` を実行して、スッキリしましょう！

---
みなさま、良いお年を～！ 🎍
